#:import md_icons kivymd.icon_definitions.md_icons
#:import fonts kivymd.font_definitions.fonts
#:import Tab widgets.Tab
#:import ContentNavigationDrawer widgets.ContentNavigationDrawer
#: import OweTextField widgets.OweTextField


<ContentNavigationDrawer>:
    orientation: "vertical"
    padding: "8dp"
    spacing: "8dp"

    AnchorLayout:
        anchor_x: "left"
        size_hint_y: None
        height: avatar.height

        Image:
            id: avatar
            size_hint: None, None
            size: "56dp", "56dp"
            source: "data/logo/money_payroll-photoaidcom-cropped.png"

    MDLabel:
        text: app.title
        font_style: "Button"
        size_hint_y: None
        height: self.texture_size[1]

    MDLabel:
        text: app.by_who
        font_style: "Caption"
        size_hint_y: None
        height: self.texture_size[1]

    MDNavigationDrawerMenu:
        MDNavigationDrawerDivider:

        MDNavigationDrawerItem:
            icon: "information-outline"
            text: "Информация"
            on_release: app.show_info()

        MDNavigationDrawerItem:
            icon: "exit-to-app"
            text: "Выход"
            on_release: app.close_app()

<InfoContent>
    orientation: "vertical"
    size_hint_y: None
    height: "400dp"
    MDBoxLayout:
        MDScrollView:

            MDList:
                padding: [20, 30, 20, 20]
                id: info_content

<MemberRow>:
    size_hint_y: None
    height: "42dp"
    canvas:
        Color:
            rgba: root.color
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        MDIconButton:
            icon: "account"
            theme_text_color: "Custom"
            text_color: app.md_bg_color

        OweTextField:
            id: name

            name: 'name'
            icon: "account"

        MDIconButton:
            icon: "cash-multiple"
            theme_text_color: "Custom"
            text_color: app.md_bg_color

        OweTextField:
            id: expenses
            input_filter: 'float'


MDScreen:

    MDNavigationLayout:
        MDScreenManager:

            MDScreen:

                MDBoxLayout:
                    orientation: "vertical"

                    MDTopAppBar:
                        title: "Сколько должен"
                        left_action_items: [["menu", lambda x: nav_drawer.set_state()]]
                        md_bg_color: app.md_bg_color
                        anchor_title: "left"

                    MDTabs:
                        id: tabs
                        background_color: app.md_bg_color
                        tab_hint_x: True
                        allow_stretch: True

                        Tab:
                            title: f"[size=18sp][font={fonts[-1]['fn_regular']}]{md_icons['account-group']}[/size][/font] [size=18sp][/font][/ref] Участники"

                            BoxLayout:
                                padding: [20, 30, 20, 0]
                                pos_hint: {"top": 1}
                                adaptive_height: True
                                orientation: 'vertical'

                                MDBoxLayout:
                                    pos_hint: {"top": 1}
                                    adaptive_height: True

                                    MDIconButton:
                                        icon: "account-multiple-plus"
                                        theme_text_color: "Custom"
                                        text_color: app.md_bg_color

                                    MDTextField:
                                        id: participant_count
                                        hint_text: 'Количество'
                                        helper_text_mode: "on_focus"
                                        helper_text: 'max=99'
                                        max_text_length: 2
                                        line_color_focus: app.md_bg_color
                                        input_filter: 'int'

                                    FlatButton:
                                        text: "Создать таблицу"
                                        on_release: app.create_table_to_add_data()


                                BoxLayout:
                                    pos_hint: {'center_x': 0, }
                                    adaptive_height: True
                                    orientation: 'vertical'
                                    padding: [0, 20, 25, 80]
                                    ScrollView:
                                        MDList:
                                            id: table_list

                            MDBoxLayout:
                                orientation: 'horizontal'
                                padding: [20, 20, 20, 20]

                                MDBoxLayout:
                                    orientation: 'horizontal'
                                    FlatButton:
                                        text: 'Добавить'
                                        on_release: app.add_row()

                                MDBoxLayout:
                                    orientation: 'horizontal'
                                    FlatButton:
                                        text: 'Удалить'
                                        on_release: app.remove_row()

                                MDBoxLayout:
                                    orientation: 'horizontal'
                                    FlatButton:
                                        text: 'Рассчитать'



                        Tab:
                            title: f"[size=18sp][font={fonts[-1]['fn_regular']}]{md_icons['account-cash']}[/size][/font] [size=18sp][/font][/ref] Расчет"
                            BoxLayout:
                                orientation: 'vertical'
                                pos_hint: {"top": 1}
                                adaptive_height: True
                                padding: [20, 30, 20, 20]
                                MDBoxLayout:

                                    ScrollView:
                                        MDList:
                                            id: result


        MDNavigationDrawer:
            id: nav_drawer
            ContentNavigationDrawer:
                id: content_drawer
